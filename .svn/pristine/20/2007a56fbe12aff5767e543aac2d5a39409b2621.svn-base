package group9.GridCollageGenerator;

import javax.imageio.ImageIO;
import java.awt.*;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.IOException;
import java.util.ArrayList;

public class Collage {
    private final int width;
    private final int height;
    private final ArrayList<CollageImage> collageImages;
    private BufferedImage collage;
    private static Color backgroundColor = Color.BLACK;

    public Collage(int width, int height) {
        this.width = width;
        this.height = height;
        this.collageImages = new ArrayList<>();
    }

    public static void setBackgroundColor(Color col)
    {
        backgroundColor = col;
    }

    public void addImage(BufferedImage image, int x, int y) {
        CollageImage collageImage = new CollageImage(image, x, y);
        collageImages.add(collageImage);
    }

    public void addImage(BufferedImage image, int x, int y, int width, int height) {
        CollageImage collageImage = new CollageImage(image, x, y, width, height);
        collageImages.add(collageImage);
    }

    public void draw() {
        collage = new BufferedImage(width, height, BufferedImage.TYPE_INT_RGB);
        Graphics2D g2 = collage.createGraphics();
        g2.setColor(backgroundColor);
        g2.fillRect(0,0,width, height);
        for (CollageImage collageImage : collageImages)
            g2.drawImage(collageImage.getImage(),  collageImage.getPosX(), collageImage.getPosY(), collageImage.getWidth(), collageImage.getHeight(), null);
        g2.dispose();
    }

    public BufferedImage getCollageAsImage() {
        draw();
        return collage;
    }

    public static Color getBackgroundColor() {
        return backgroundColor;
    }

    public void save(String filename) throws IOException {
        File outfile = new File(filename + ".jpg");
        ImageIO.write(collage, "jpg", outfile);
    }
}
